\documentclass[a4paper, 12pt]{article}
\usepackage{geometry}
\geometry{top=2.54cm, bottom=2.54cm, left=2.54cm, right=2.54cm, heightrounded}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel} 
\usepackage{amsthm, amsmath, amssymb, amsfonts, amscd}
\usepackage{mathtools}
\usepackage{fancyhdr}
\usepackage{setspace}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{ifluatex}
\usepackage{array}
\usepackage{multirow}
\usepackage[table]{xcolor}
\usepackage{tcolorbox}
\usepackage{mdframed}

% ---- Spacing ---- %
\linespread{1.0}
\onehalfspacing

% ---- Page header ---- %
\pagestyle{fancy}
\headheight 30pt
\fancyhf{}
\rhead{Page \thepage}
\lhead{\nouppercase{Infinite number of primes in ${k}n+{ell}$, $n\geqslant 0$}}
\headsep 1.5em

% ---- Link & URL style ---- %
\hypersetup{colorlinks, citecolor=green, linkcolor=blue, urlcolor=blue}
\urlstyle{rm}

% ---- Paragraph indentation style ---- %
\setlength{\parindent}{20pt}

% ---- Box ---- %
\definecolor{framecolor}{rgb}{0.5, 0.5, 0.5}
\definecolor{backcolor}{rgb}{0.94, 0.97, 1.0}
\newtcolorbox{mybox}{colback=backcolor, colframe=framecolor, boxrule=0.5pt, arc=3pt}

% ---- Theorems ---- %
\newtheorem{theorem}{Theorem}%[section]
\newtheorem{lemma}[theorem]{Lemma}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

% ---- Definitions ---- %
\renewcommand{\qedsymbol}{\rule{0.7em}{0.7em}} % Black box to end proofs. 
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\Q}{\ensuremath{\mathbb{Q}}}
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\F}{\ensuremath{\mathbb{F}}}
\DeclareMathOperator{\degpol}{deg} % Degree of a polynomial.
\DeclareUnicodeCharacter{03B6}{\zeta} % Define Unicode Character 'Î¶'.
\newcommand{\splitatcommas}[1]{%
  \begingroup
  \begingroup\lccode`~=`, \lowercase{\endgroup
    \edef~{\mathchar\the\mathcode`, \penalty0 \noexpand\hspace{0pt plus 1em}}%
  }\mathcode`,="8000 #1%
  \endgroup
}% Break long inline expressions after comma sign.
\renewcommand\title{\textbf{The arithmetic progression ${k}n+{ell}$, $n\geqslant0$, contains infinitely many primes.\\ A Euclidean proof}}

\begin{document}
\thispagestyle{plain}
\pagenumbering{arabic}
\sloppy
\begin{center}
{\huge \bfseries \title\par}
\vspace{1cm}
\end{center}

\begin{mybox}
{\Large \textbf{About this document}}
\vspace{0.3cm}\\
\textit{This file has been automatically generated for the user-supplied arithmetic progression. The code behind this document can be found in the url \url{https://github.com/joarca01/final-math-bsc-thesis}, and has been developed as part of a BSc Thesis in Mathematics by Joan Arenillas i Cases at the Autonomous University of Barcelona. The above link also provides full access to the complete Thesis. Please use \href{mailto:joanarenillas01@gmail.com}{\nolinkurl{joanarenillas01@gmail.com}} to report any typo or express any suggestions.}
\end{mybox}
\vspace{0.5cm}

We will prove that the arithmetic progression $\equiv {ell} \pmod{{k}}$ contains infinitely many primes. Equivalently, we will see that there are infinitely many primes of the form ${k}n+{ell}$, $n\geqslant0$. To follow the proof, one must recall the expression of the discriminant of a polynomial. 
\begin{definition}
The discriminant of a monic polynomial $A(x)=x^d+a_{d-1}x^{d-1}+\cdots+a_1x+a_0$ is given, in terms of its roots $\{r_1,r_2,\dots,r_d\}\subset\C$ (not necessarily distinct), by
\begin{equation}\label{eq:discrim}
	\Delta(A)=\prod_{i<j}(r_i-r_j)^2, \quad 1\leqslant i,j\leqslant d.
\end{equation}
\end{definition}
It will be useful to remember that the ${k}${sufix_cyclo_alt} cyclotomic polynomial is $\Phi_{{k}}(x)={cyclotomic_polynomial}$. We shall also define what a \emph{prime divisor} of a given polynomial is.
\begin{definition}
Let $A(x)\in\Z[x]$ be a polynomial. We say that a prime number $p$ is a \emph{prime divisor} of $A$ (or simply that $p$ \emph{divides} $A$) if there exists $m\in\Z$ such that $p$ divides $A(m)$.
\end{definition}

\section{The main Theorem}\label{sec:mainTh}

We are now able to show that there exist infinitely many primes $\equiv 1\pmod{{k}}$. For this purpose, consider the polynomial 
\begin{equation*}
\binoppenalty=10000 % no line break after \cdot
\mathchardef\plus=\mathcode`+ % save the mathcode
\mathcode`+="8000 % make the plus math active
\thinmuskip=0mu
\begingroup\lccode`~=`+
  \lowercase{\endgroup\def~}{%
    \plus\allowbreak\hspace{0pt plus 2pt}%
}
\hphantom{}
\parbox{1.0\displaywidth}{\centering\linespread{1.1}\selectfont
  \makebox[0pt][r]{$ $}$\Phi_{{k}}(x)={cyclotomic_polynomial}.$
}
\end{equation*}
We will specifically show that every prime divisor $p$ of $\Phi_{{k}}(x)$ {prime_divisors_disc_cyclo_alt} To see this, consider the set $S:=\splitatcommas{\{{coset_reps_list}\}}$ and the values $\zeta^{s}$, with $s\in S$ and $\zeta:=e^{2\pi i/{{k}}}$, a ${k}${sufix_cyclo_alt} primitive root of unity (thus a root of $\Phi_{{k}}(x)$). A simple calculation shows that $\Phi_{{k}}(x)$ can be written as
\begin{equation*}
\binoppenalty=10000 % no line break after \cdot
\mathchardef\plus=\mathcode`+ % save the mathcode
\mathcode`+="8000 % make the plus math active
\thinmuskip=0mu
\begingroup\lccode`~=`+
\lowercase{\endgroup\def~}{%
	\plus\allowbreak\hspace{0pt plus 2pt}%
}
\hphantom{}
\parbox{1.0\displaywidth}{\centering\linespread{1.1}\selectfont
	\makebox[0pt][r]{$ $}$\Phi_{{k}}(x)=\displaystyle\prod_{s\in S}\big(x-\zeta^{s}\big)={cyclotomic_polynomial}.$
}
\end{equation*}
{disc_cyclo_value_alt}

Now, suppose that $p$ is a prime divisor of $\Phi_{{k}}$ such that $p$ does not belong to $T$. Next, consider a field $\F$ containing both the finite field $\F_p$ and $\zeta$\footnote{For instance, consider $\F=\F_{p^n}$ with a suitable integer $n\geqslant 1$ such that $\Phi_{{k}}$ has a root $\zeta$. In this context, $\zeta$ is not the complex root of $\Phi_{{k}}$, but rather some root of an irreducible factor of $\overline{\Phi_{{k}}}\in\F_p[x]$ over $\F_p$.}. Since $p$ divides $\Phi_{{k}}$, working in $\F$, there exists $a\in\Z$ such that 
\begin{equation*}
\Phi_{{k}}(a)=\prod_{s'\in S}\big(a-\zeta^{s'}\big)=0.
\end{equation*}
Since $\F$ is a field, there exists some $s\in S$ such that $a=\zeta^{s}$.
\begin{lemma}
The equality $\zeta^s=\zeta^{ps}$ holds in $\F$.
\end{lemma}
\begin{proof}
Observe that the following calculation holds in $\F$:
\begin{equation}\label{eq:reproots}
\zeta^{s}=a=a^p=\zeta^{ps},
\end{equation}
where we have used Fermat little theorem in the second equality. 
\end{proof}

Therefore, equality \eqref{eq:reproots} means that $\zeta^{ps}=\zeta^{s}$ is a root of $\overline{\Phi_{{k}}(x)}\in\F[x]$. 

\begin{lemma}
$\zeta^{ps}$ is also a root of $\Phi_{{k}}(x)$ in $\Q(\zeta)$ $($the smallest subfield of $\C$ containing $\zeta)$.
\end{lemma}
\begin{proof}
Begin by noting that the value $\zeta^{ps}$ only depends on the value of $ps \bmod{{k}}$ since it only appears as an exponent of $\zeta$. Since $p$ does not divide ${k}$ and $s$ is coprime to ${k}$, $ps$ is coprime to ${k}$ (so $ps \bmod{{k}}$ is coprime to ${k}$) and hence $\zeta^{ps}$ is a primitive ${k}${sufix_cyclo_alt} root of unity. Thus, $\zeta^{ps}$ is a root of $\Phi_{{k}}(x)$ in $\Q(\zeta)$.
\end{proof}

\begin{lemma}
$\zeta^{ps}$ and $\zeta^{s}$ are the same root of $\Phi_{{k}}(x)$ in $\Q(\zeta)$.
\end{lemma}
\begin{proof}
If $\zeta^{ps}$ and $\zeta^{s}$ were two distinct roots of $\Phi_{{k}}(x)$ in $\Q(\zeta)$, we know because of \eqref{eq:reproots} that they would be the same in $\F$. Therefore, observing expression \eqref{eq:discrim}, it follows that $\Delta(\Phi_{{k}} \bmod{p})=\Delta(\Phi_{{k}}) \bmod{p}=0$, so $p$ divides $\Delta(\Phi_{{k}})={factor_discriminant}$. This is a contradiction with our choice of $p$. Thus, $\zeta^{ps}$ and $\zeta^{s}$ are in fact the same root of $\Phi_{{k}}(x)$ in $\Q(\zeta)$.
\end{proof}

Therefore, the equality
\begin{equation}\label{eq:equality_in_zeta}
\zeta^{ps}=\zeta^{s}
\end{equation}
holds in $\Q(\zeta)$. 
\begin{lemma}
The fact that \eqref{eq:equality_in_zeta} holds implies that $p \bmod{{k}}=1$.
\end{lemma}
\begin{proof}
Write the above equation in terms of $\theta:=\zeta^{s}$. This change yields
\begin{equation*}
\theta^{p}=\theta,
\end{equation*}
where observe that $\theta$ is also a primitive ${k}${sufix_cyclo_alt} root of unity. Now, the right-hand side of the equation above does not depend on $p$. The left-hand side only depends on the value of $p\bmod{{k}}$, since $p$ only appears as an exponent of $\theta$. In conclusion, equality \eqref{eq:equality_in_zeta} only holds if $p \bmod{{k}}=1$, that is, if $p\equiv 1\pmod{{k}}$.
\end{proof}

In conclusion, every prime divisor $p$ of $\Phi_{{k}}$ {prime_divisors_disc_cyclo_alt} In Section \ref{sec:properties} we will establish that the polynomial $\Phi_{{k}}$ has infinitely many prime divisors. But, from the remark above, all these prime divisors must be $\equiv 1\pmod{{k}}$ (except for those $p\in T$). This concludes the proof that there are infinitely many primes $\equiv {ell} \pmod{{k}}$.

\section{Property of the polynomial \texorpdfstring{$\Phi_{{k}}(x)$}{Pkx}}\label{sec:properties}

We just need the following lemma to complete the proof of the main Theorem in Section \ref{sec:mainTh}.

\begin{lemma}
The cyclotomic polynomial $\Phi_{{k}}(x)\in\Z[x]$ has infinitely many prime divisors.
\end{lemma}
\begin{proof}
There is obviously at least one prime divisor of $\Phi_{{k}}$, since the case $\Phi_{{k}}(x)={cyclotomic_polynomial}=\pm 1$ only happens for a finite number of integer values of $x$. Now suppose $\Phi_{{k}}$ has only a finite number of prime divisors, say $p_1, p_2,\dots,p_k$ and let $Q:=p_1p_2\cdots p_k$. 

Observe that $\degpol(\Phi_{{k}})={eulersphi_k}$ and $\Phi_{{k}}(0)={indep_coef_cyclotomic}\neq 0$. Then, $\Phi_{{k}}(Qx)=g(x)$ for some $g(x)\in\Z[x]$ of the form {polynom_aux_alt} This, together with the fact that $p$ divides $g(m)$, would imply that $p$ divides $g(m) - \sum_{i=1}^{{eulersphi_k}}c_im^i=1$, which means $p=1$, a contradiction. 

Now, $p$ is a prime divisor of $\Phi_{{k}}$, but $p$ is not any of the primes $p_1,p_2,\dots,p_k$, since we just proved that $p$ does not divide $p_1p_2\cdots p_k=Q$. Thus, we found a new prime divisor of $\Phi_{{k}}$ not in our list, so one concludes that $\Phi_{{k}}$ has infinitely many prime divisors.
\end{proof}

\end{document}